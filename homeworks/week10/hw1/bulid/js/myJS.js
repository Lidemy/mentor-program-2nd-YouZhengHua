"use strict";function showEdit(t){var n=t.closest(".postAction");$(n.querySelector(".postAction__textarea")).show(400),$(n.querySelector(".postAction__edit--submit")).show(400),$(n.querySelector(".postAction__edit--cancel")).show(400),$(n.querySelector(".postAction__edit--show")).hide(),$(n.previousElementSibling).hide()}function cancelEdit(t){var n=t.closest(".postAction");$(n.querySelector(".postAction__textarea")).hide(),$(n.querySelector(".postAction__edit--submit")).hide(),$(n.querySelector(".postAction__edit--cancel")).hide(),$(n.querySelector(".postAction__edit--show")).show(),$(n.previousElementSibling).show()}function addSubComments(e){var t=$(e).find("textarea[name=contnet]").val();$(e).find("textarea[name=contnet]").val("");var n=$(e).find("input[name=parentId]").val();$.ajax({type:"POST",url:"add_comments.php",data:{contnet:t,parentId:n},success:function(t){var n=JSON.parse(t);"success"===n.rtnCde&&$(e).parents(".main__post").find(".main__post__subfrom").before('\n\t\t\t\t<div class="main__subpost main__subpost--self">\n\t\t\t\t\t<div class="main__subpost__info">\n\t\t\t\t\t\t<div class="main__subpost__info--name">\n\t\t\t\t\t\t\t'+n.crt_user+'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="main__subpost__info-time">\n\t\t\t\t\t\t\t'+n.crt_time+'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="main__subpost__comment--text">\n\t\t\t\t\t\t'+n.contnet+'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="postAction">\n\t\t\t\t\t\t<div class="postAction__edit">\n\t\t\t\t\t\t\t<form action="edit_comments.php" method="POST">\n\t\t\t\t\t\t\t\t<div class="margin-bot-10">\n\t\t\t\t\t\t\t\t\t<textarea class="postAction__textarea wt-90" name="contnet" placeholder="留言內容" style="display: none;">'+n.contnet+'</textarea>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<input type="hidden" name="commentId" value="'+n.id+'">\n\t\t\t\t\t\t\t\t<button type="submit" class="btn postAction__edit--submit" style="display: none;">送出</button>\n\t\t\t\t\t\t\t\t<button type="button" class="btn postAction__edit--cancel" style="display: none;">取消</button>\n\t\t\t\t\t\t\t\t<button type="button" class="btn postAction__edit--show" value="edit">編輯</button>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="postAction__del postAction__del--sub">\n\t\t\t\t\t\t\t<input type="hidden" name="commentId" value="'+n.id+'">\n\t\t\t\t\t\t\t<button class="btn postAction__del--submit" value="del">刪除</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>')},error:function(){}})}function addMainComments(t){var n=$(t).find("textarea[name=contnet]").val();$(t).find("textarea[name=contnet]").val("");var e=$(t).find("input[name=parentId]").val();$.ajax({type:"POST",url:"add_comments.php",data:{contnet:n,parentId:e},success:function(t){var n=JSON.parse(t);"success"===n.rtnCde&&$(".main__posts").prepend('\n\t\t\t\t<div class="row">\n\t\t\t\t\t<div class="main__post col div-border">\n\t\t\t\t\t\t<div class="main__post__info">\n\t\t\t\t\t\t\t<div class="main__post__info--name">\n\t\t\t\t\t\t\t\t'+n.crt_user+'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="main__post__info-time">\n\t\t\t\t\t\t\t\t'+n.crt_time+'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="main__post__comment--text">\n\t\t\t\t\t\t\t'+n.contnet+'\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="postAction">\n\t\t\t\t\t\t\t\t<div class="postAction__edit wt-90">\n\t\t\t\t\t\t\t\t\t<form action="edit_comments.php" method="POST">\n\t\t\t\t\t\t\t\t\t\t<div class="margin-bot-10">\n\t\t\t\t\t\t\t\t\t\t\t<textarea class="postAction__textarea wt-100" name="contnet" placeholder="留言內容" style="display: none;">'+n.contnet+'</textarea>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="commentId" value="'+n.id+'">\n\t\t\t\t\t\t\t\t\t\t<button type="submit" class="btn postAction__edit--submit" style="display: none;">送出</button>\n\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn postAction__edit--cancel" style="display: none;">取消</button>\n\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn postAction__edit--show" value="edit">編輯</button>\n\t\t\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="postAction__del">\n\t\t\t\t\t\t\t\t\t<input type="hidden" name="commentId" value="'+n.id+'">\n\t\t\t\t\t\t\t\t\t<button class="btn postAction__del--submit" value="del">刪除</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="main__post__subfrom" style="display: none;">\n\t\t\t\t\t\t\t<div class="main__post__subfrom--nickname">\n\t\t\t\t\t\t\t\t'+n.crt_user+'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<textarea class="main__post__subfrom--textarea wt-90 margin-bot-10" name="contnet" placeholder="留言內容"></textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<input class="btn btn-primary btn-lg" type="button" value="送出">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<input type="hidden" name="parentId" value="'+n.id+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="margin-top-10">\n\t\t\t\t\t\t\t<input class="btn btn-primary subfromFrom--show" type="button" value="我要留言">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>')},error:function(){}})}function delComments(t){if("del"===$(t).val())$(t).text("確認刪除"),$(t).val("confirm"),$(t).addClass("btn-danger"),$(t).mouseout(function(){$(t).removeClass("btn-danger"),$(t).text("刪除"),$(t).val("del")});else{delElement=$(t).parents(".postAction__del");var n=$(delElement).find("input[name=commentId]").val();$.ajax({type:"POST",url:"del_comments.php",data:{commentId:n},success:function(t){"success"===JSON.parse(t).rtnCde&&$(delElement).parent("div").parent("div").remove()},error:function(){}})}}$(document).ready(function(){$(".main__from").find("input[type=button]").bind("click",function(){addMainComments($(".main__from"))}),$(".main__posts").on("click",".main__post__subfrom input[type=button]",function(t){addSubComments($(t.currentTarget).parents(".main__post__subfrom"))}),$(".main__posts").on("click",".postAction__edit--show",function(t){showEdit(t.currentTarget)}),$(".main__posts").on("click",".postAction__edit--cancel",function(t){cancelEdit(t.currentTarget)}),$(".main__posts").on("click",".postAction__del--submit",function(t){delComments(t.currentTarget)}),$("body").on("click",".subfromFrom--show",function(t){$(t.currentTarget).hide(300,function(){$(t.currentTarget).parent().prev().show(400)})})});